shadow() {
  local FOO="${1}"
  echo "$( ( typeset +x FOO; printenv FOO ) 2>/dev/null || printenv FOO 2>/dev/null || true )"
  echo "$FOO"
}

main() {
  (
    export FOO="outer"
    shadow "local"
  )
}

main "$@"
