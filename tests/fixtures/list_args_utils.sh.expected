#!/usr/bin/env bash
__sh2_err_handler() {
  local s=$?
  local loc="${__sh2_loc:-}"
  if [[ "${BASH_COMMAND}" == *"(exit "* ]]; then return $s; fi
  if [[ -z "$loc" ]]; then return $s; fi
  if [[ "$loc" == "${__sh2_last_err_loc:-}" && "$s" == "${__sh2_last_err_status:-}" ]]; then return $s; fi
  __sh2_last_err_loc="$loc"
  __sh2_last_err_status="$s"
  printf "Error in %s\n" "$loc" >&2
  return $s
}
set -o errtrace
trap '__sh2_err_handler' ERR
test() {
  local __sh2_loc=""
  printf '%s\n' "$#"
  printf '%s\n' "$1"
  printf '%s\n' "$3"
  printf '%s\n' "$( arr=("$@"); idx=$(( 0 )); printf "%s" "${arr[idx]}" )"
  printf '%s\n' "$( arr=("$@"); idx=$(( 2 )); printf "%s" "${arr[idx]}" )"
  printf '%s\n' "$( IFS='-'; printf "%s" "$*" )"
  printf '%s\n' "$#"
  for a in "$@"; do
    printf '%s\n' "$a"
  done
}

main() {
  local __sh2_loc=""
  __sh2_loc="tests/fixtures/list_args_utils.sh2:23:3"
  xs=('a' 'b' 'c')
  printf '%s\n' "${#xs[@]}"
  printf '%s\n' "${xs[1]}"
  printf '%s\n' "$( IFS='-'; printf "%s" "${xs[*]}" )"
  for item in "${xs[@]}"; do
    printf '%s\n' "$item"
  done
  __sh2_loc="tests/fixtures/list_args_utils.sh2:35:3"
  'test' 'x' 'y' 'z'; __sh2_status=$?; (exit $__sh2_status)
}
__sh2_status=0
main "$@"
